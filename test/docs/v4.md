# 메시지 리마인더 v4 - 지능형 AI 챗봇 완성

## 완료된 개선사항 ✅

### 1. 현재 시간 기반 오전/오후 구분 개선
- **문제**: "오늘 6시"와 같은 모호한 시간 표현에서 오전/오후 구분 어려움
- **해결**: 현재 시간 정보를 AI에게 전달하여 맥락 기반 시간 추론
- **구현**: 
  - 현재 날짜, 시간, 요일 정보를 AI API에 전달
  - 시간 추론 가이드라인 추가
  - 예시: 현재 오전이면 "6시" → "06:00", 오후면 "18:00"

### 2. 향상된 AI 추측 능력
- **문제**: 입력 조건에 맞지 않을 때 단순한 오류 메시지만 표시
- **해결**: AI가 실패해도 정규식 기반 추측 로직으로 폴백
- **구현**:
  - `parseWithEnhancedRegex` 메서드 추가
  - 더 관대한 추측 로직으로 제목, 날짜, 시간 추출
  - 기본값 설정 (날짜 없으면 내일, 제목 추측 등)
  - 향상된 안내 메시지 제공

### 3. 자동 일정 예약 기능
- **문제**: 일정 정보가 완전해도 사용자가 수동으로 예약 버튼을 눌러야 함
- **해결**: 일정 정보가 완전할 때 자동으로 등록
- **구현**:
  - `useChat` 훅에서 자동 일정 등록 로직 추가
  - 성공 메시지 자동 표시
  - UI에서 "일정 자동 등록됨" 상태 표시
  - 예약 버튼 제거하고 자동 처리

### 4. 기존 일정 수정 기능
- **문제**: 이미 등록된 일정을 수정할 수 없음
- **해결**: 자연어로 기존 일정 수정 가능
- **구현**:
  - 수정 의도 감지 키워드 추가
  - 기존 일정 목록을 AI에게 전달
  - `updateData` 필드로 수정 정보 전달
  - 수정 성공 시 UI 피드백 제공

### 5. 일반 대화 기능 추가
- **문제**: 일정과 관련 없는 메시지에 대한 응답 부족
- **해결**: AI 챗봇처럼 일반 대화도 처리
- **구현**:
  - 메시지 타입 판단 로직 추가 (reminder/general/update)
  - 일반 대화용 응답 생성 메서드 추가
  - 친근한 톤으로 일정 관리 기능 안내
  - 일반 대화 시 일정 등록 방지 (messageType 기반)
  - 깔끔한 UI (불필요한 표시 제거)
  - 인사말 필터링 강화 (AI 프롬프트 + 정규식 폴백)

### 6. 지능형 되물어보기 기능
- **문제**: 일정 의도가 모호하거나 정보가 부족한 경우 적절한 안내 부족
- **해결**: 구체적이고 도움이 되는 되물어보기 기능
- **구현**:
  - 일정 의도 감지 로직 추가 (hasReminderIntent)
  - 부족한 필드 파악 로직 (getMissingFields)
  - 상황별 맞춤형 되물어보기 메시지
  - AI 프롬프트에 상세한 되물어보기 가이드라인 추가

### 7. AI 자율성 강화
- **문제**: 규칙 기반 로직으로 인한 부자연스러운 제목 생성 및 판단
- **해결**: AI의 판단력을 최대한 활용하는 자율적 시스템
- **구현**:
  - AI 프롬프트 간소화 및 자율적 판단 강화
  - 제목 생성 규칙 제거, AI 맥락 이해 기반 생성
  - 메시지 타입 판단을 AI에 위임
  - 정규식 폴백 로직 간소화

## 현재 프로젝트 상태

### ✅ 구현 완료된 기능
1. **지능형 AI 챗봇**: OpenAI GPT 모델 기반 + 향상된 추측 로직
2. **자동 일정 등록**: 완전한 정보 시 자동 등록 (버튼 불필요)
3. **일정 수정 기능**: 자연어로 기존 일정 수정 가능
4. **시간 추론 개선**: 현재 시간 기반 오전/오후 구분
5. **일반 대화 기능**: 일정과 무관한 대화도 AI 챗봇처럼 처리 (인사말 필터링 + 일정 등록 방지)
6. **지능형 되물어보기**: 모호한 일정 정보에 대해 구체적으로 되물어보기
7. **AI 자율성 강화**: AI의 판단력을 최대한 활용하는 자율적 시스템
8. **일정 관리**: CRUD 기능 완전 구현 + 실시간 목록 업데이트
9. **사용자 관리**: 등록, 수정, 조회 기능 + 개선된 알림 설정
10. **이메일 알림**: Gmail SMTP를 통한 알림 발송 + 간소화된 설정 UI
11. **로컬 스토리지**: 모든 데이터 영구 저장
12. **반응형 UI**: 모바일/데스크톱 대응

### 🔧 개선된 아키텍처
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Presentation  │    │  Business Logic │    │   Data Layer    │
│     Layer       │    │     Layer       │    │     Layer       │
├─────────────────┤    ├─────────────────┤    ├─────────────────┤
│ - React Pages   │    │ - OpenAI AI     │    │ - Local Storage │
│ - Components    │    │ - Reminder Svc  │    │ - Email Service │
│ - UI Components │    │ - User Service  │    │ - JSON Storage  │
│ - 자동 등록 UI  │    │ - 하이브리드 AI │    │ - 실시간 동기화 │
│ - 수정 UI       │    │ - 시간 추론 AI  │    │ - 폴백 시스템   │
│ - 일반 대화 UI  │    │ - 메시지 타입   │    │ - 다중 모드     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 📁 프로젝트 구조 (v4 업데이트)
```
src/
├── app/                    # Next.js App Router 페이지
│   ├── chat/              # AI 챗봇 페이지 ✅ (자동 등록 + 수정 + 일반 대화)
│   ├── reminders/         # 일정 관리 페이지 ✅ (실시간 업데이트)
│   ├── profile/           # 사용자 설정 페이지 ✅ (개선된 알림 설정)
│   └── api/ai/parse-reminder/ # AI 파싱 API ✅ (시간 추론 + 수정 + 일반 대화)
├── components/            # React 컴포넌트
│   ├── ui/               # shadcn/ui 컴포넌트 ✅
│   ├── ChatBot.tsx       # AI 챗봇 컴포넌트 ✅ (자동 등록 + 수정 + 일반 대화 UI)
│   ├── ReminderList.tsx  # 일정 목록 컴포넌트 ✅ (사용자별 필터링)
│   ├── ReminderForm.tsx  # 일정 등록/수정 폼 ✅
│   ├── UserProfile.tsx   # 사용자 정보 폼 ✅ (개선된 알림 설정)
│   ├── EmailSettings.tsx # 이메일 설정 컴포넌트 ✅ (UI 간소화)
│   └── Navigation.tsx    # 네비게이션 ✅
├── hooks/                # 커스텀 React Hooks
│   ├── useReminders.ts   # 일정 관리 훅 ✅
│   ├── useUser.ts        # 사용자 관리 훅 ✅
│   └── useChat.ts        # 챗봇 훅 ✅ (자동 등록 + 수정 + 일반 대화)
├── services/             # 비즈니스 로직
│   ├── aiService.ts      # AI 챗봇 서비스 ✅ (향상된 추측 + 수정 + 일반 대화)
│   ├── reminderService.ts # 일정 관리 서비스 ✅
│   ├── userService.ts    # 사용자 관리 서비스 ✅ (기본값 개선)
│   └── emailService.ts   # 이메일 알림 서비스 ✅
├── storage/              # 데이터 저장소
│   ├── localStorage.ts   # 로컬 스토리지 서비스 ✅
│   └── jsonStorage.ts    # JSON 데이터 관리 ✅
└── types/                # TypeScript 타입 정의
    ├── reminder.ts       # 일정 타입 ✅
    ├── user.ts          # 사용자 타입 ✅ (알림 설정 확장)
    └── chat.ts          # 챗봇 타입 ✅ (수정 데이터 지원)
```

### 🛠 기술 스택 (v4 업데이트)
- **Frontend**: Next.js 14, React 18, TypeScript
- **Styling**: Tailwind CSS, shadcn/ui
- **State Management**: React Hooks (useState, useEffect, useContext)
- **Storage**: localStorage (최소 스펙)
- **Email**: Nodemailer + Gmail SMTP
- **AI**: OpenAI GPT 모델 (3.5-turbo/4/4-turbo) + 향상된 정규식 폴백
- **API Integration**: OpenAI API (시간 추론 + 수정 + 일반 대화 지원)

### 🔐 보안 개선사항 (v4)
1. **환경변수 관리**: Gmail 계정 정보와 OpenAI API 키를 .env.local에서 관리
2. **입력 검증**: 모든 사용자 입력에 대한 유효성 검사
3. **에러 처리**: 적절한 에러 메시지 및 예외 처리
4. **UI 보안**: 민감한 설정 정보 노출 최소화
5. **API 보안**: OpenAI API 키 환경변수 보호
6. **폴백 시스템**: AI 실패 시 정규식 기반 안전한 처리

### 📋 사용 방법 (v4 업데이트)
1. **환경변수 설정**: 프로젝트 루트에 `.env.local` 파일 생성
   ```bash
   # Gmail 봇 계정 설정
   GMAIL_USER=your-gmail-bot@gmail.com
   GMAIL_APP_PASSWORD=your-16-digit-app-password
   
   # OpenAI API 설정 (선택사항)
   OPENAI_API_KEY=your-openai-api-key-here
   
   # GPT 모델 설정 (선택사항)
   OPENAI_MODEL=gpt-3.5-turbo  # 또는 gpt-4, gpt-4-turbo
   OPENAI_TEMPERATURE=0.3      # 창의성 수준 (0.0-2.0)
   OPENAI_MAX_TOKENS=500       # 최대 응답 길이
   ```
2. **사용자 등록**: 프로필 페이지에서 이메일 주소 및 알림 설정 등록
3. **알림 설정**: 
   - 이메일 알림 받기 체크박스
   - 일정 시작 전 알림 받기 체크박스
   - 몇분 전에 알림 받을지 선택 (5분~1일 전)
   - 일일 알림 시간 설정
4. **지능형 일정 입력**: AI 챗봇을 통해 자연어로 일정 입력
   - 정보가 부족하면 AI가 구체적으로 요청
   - 충분한 정보가 있으면 자동으로 일정 등록
   - "오늘 6시"와 같은 모호한 시간도 현재 시간 기반으로 추론
5. **일정 수정**: 자연어로 기존 일정 수정
   - "회의 시간을 3시로 바꿔줘"
   - "내일 치킨 먹기 제목을 저녁 치킨 먹기로 변경"
6. **일반 대화**: 일정과 무관한 대화도 AI 챗봇처럼 처리
   - "안녕하세요", "오늘 날씨 어때요?" 등
   - 친근한 톤으로 일정 관리 기능 안내
   - 일반 대화 시에는 일정 등록하지 않음
   - 인사말("하이요", "안녕") 필터링으로 의도치 않은 일정 등록 방지
7. **지능형 되물어보기**: 모호한 일정 정보에 대해 구체적으로 되물어보기
   - "치킨 먹기" → "언제 치킨을 드실 예정인가요? 오늘, 내일, 아니면 다른 날짜인가요?"
   - "3시에 회의" → "회의가 언제 3시에 있나요? 오늘, 내일, 아니면 다른 날짜인가요?"
   - "내일 회의" → "내일 몇 시에 회의가 있나요? 시간을 알려주세요."
8. **AI 자율성 강화**: AI의 판단력을 최대한 활용
   - 제목 생성 규칙 제거, AI 맥락 이해 기반 자연스러운 제목 생성
   - 메시지 타입 판단을 AI에 위임하여 더 정확한 분류
   - 정규식 폴백 로직 간소화로 AI 의존도 증가
9. **일정 관리**: 일정 목록에서 실시간으로 수정, 삭제, 완료 처리
10. **이메일 알림**: 설정된 시간에 자동 알림 발송

### 🚀 다음 개선 계획
1. **데이터베이스 연동**: localStorage 대신 실제 DB 사용
2. **사용자 인증**: 로그인/회원가입 시스템
3. **AI 모델 업그레이드**: GPT-4 또는 최신 모델 사용
4. **알림 다양화**: SMS, 푸시 알림 등 추가
5. **일정 공유**: 다른 사용자와 일정 공유 기능
6. **알림 히스토리**: 발송된 알림 기록 관리
7. **반복 일정**: 주간/월간 반복 일정 설정
8. **음성 입력**: 음성으로 일정 등록 기능
9. **캘린더 연동**: Google Calendar, Outlook 등 외부 캘린더 연동
10. **일정 템플릿**: 자주 사용하는 일정 패턴 저장
11. **스마트 알림**: 사용자 패턴 학습 기반 알림 시간 조정